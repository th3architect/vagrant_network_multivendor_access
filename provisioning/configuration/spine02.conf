daemon TerminAttr
   exec /usr/bin/TerminAttr -ingestgrpcurl=10.255.1.100:9910 -taillogs -ingestauth=key, -ingestvrf MGMT
   no shutdown
!
email
   from-user ansible_lab@email.com
   server vrf MGMT mail.test.com
!
!
load-interval default 30
!
hostname spine02
!
ip name-server vrf MGMT 10.255.1.1
!
ip domain-name example.com
!
ntp source Management1
ntp server vrf MGMT 10.255.1.1
!
aaa authorization exec default local
!
no aaa root
!
username cvpadmin privilege 15 secret sha512 $6$i1wYXKTOekzKY648$kTUM2S/KMGh.vgRVYEQZdoDcWJsF4zk.uFIDxdBB.rJjL34Br3hKDJ.NMJSwFYu7nzLlzDCEWIRhCn4DnQHU71
!
!
clock timezone CST6CDT
!
aaa group server radius radius_aaa
    server 10.255.1.1 vrf MGMT
    server 10.255.1.2 vrf MGMT
aaa authentication login default group radius group radius_aaa local
aaa authorization exec default group radius_aaa local none
aaa accounting exec default start-stop group radius group radius_aaa
spanning-tree mode mstp
no spanning-tree vlan 4094
!
vlan 4094
    name MLAG-PEER
    trunk group MLAG-PEER
!
vlan 11
    name LEAF01
!
vlan 12
    name LEAF02
!
vlan 13
    name LEAF03
!
vlan 14
    name LEAF04
!
vlan 15
    name LEAF05
!
vlan 16
    name LEAF06
!
vlan 17
    name LEAF07
!
vlan 18
    name LEAF08
!
vlan 19
    name LEAF09
!
!
vrf definition MGMT
    rd 1:1
!
interface Port-Channel1
   description TRUNK_BOND
   switchport mode trunk
   switchport trunk native vlan 1
   switchport trunk allowed vlan 10-19
   port-channel lacp fallback individual
   port-channel lacp fallback timeout 5
   mlag 1
   spanning-tree portfast
   spanning-tree bpduguard enable
!
interface Port-Channel2
   description ACCESS_BOND
   switchport mode access
   switchport access vlan 2
   port-channel lacp fallback individual
   port-channel lacp fallback timeout 5
   mlag 2
   spanning-tree portfast
   spanning-tree bpduguard enable
!
!
interface Ethernet1
   description aggregation01_spine02
   no switchport
   ip address 10.102.1.1/31
!
interface Ethernet2
   description aggregation02_spine02
   no switchport
   ip address 10.202.1.1/31
!
interface Ethernet3
   description spine01_leaf01
   no switchport
   ip address 10.255.11.0/31
!
interface Ethernet4
   description spine01_leaf02
   no switchport
   ip address 10.255.12.0/31
!
interface Ethernet5
   description spine01_leaf03
   no switchport
   ip address 10.255.13.0/31
!
interface Ethernet6
   description spine01_leaf04
   no switchport
   ip address 10.255.14.0/31
!
interface Vlan11
    description FLOOR_11_DATA
    mtu 9214
    ip address 10.11.0.2/24
    ip virtual-router address 10.11.0.1
!
!
ip route vrf MGMT 0.0.0.0/0 10.0.2.2
!
ip routing
ip routing vrf MGMT
!
ip routing
!
router bgp 102.1
    router-id 192.168.102.2
    bgp log-neighbor-changes
    maximum-paths 32 ecmp 32
    distance bgp 20 200 200
    neighbor aggregation peer-group
    neighbor 10.102.1.0 remote-as 65000
    neighbor 10.102.1.0 peer-group aggregation
    neighbor 10.202.1.0 remote-as 65000
    neighbor 10.202.1.0 peer-group aggregation
    neighbor aggregation description AGGREGATION_TO_SPINE
    neighbor aggregation password CUMULUS_ARISTA
!
address-family ipv4
    neighbor aggregation activate
    neighbor aggregation route-map BGP_PERMIT_ONLY_DEFAULT_ROUTE in
    neighbor aggregation route-map BGP_DISTRIBUTION out
!


banner motd
******************************WARNING************************************
This system is for authorized users only. This, and any other sessions,
can and will be monitored to determine whether or not it is being used
by an authorized user.

By logging into this system, you are consenting to such monitoring, and
are advised that the system administrators retain the right to use any
recorded session as evidence of criminal activity, if such activity is
monitored.
******************************WARNING************************************
EOF
!
ip prefix-list DEFAULT_ROUTE seq 10 permit 0.0.0.0/0
ip prefix-list ANY seq 5 permit 0.0.0.0/0 le 32
ip prefix-list FLOOR_11 seq 10 permit 10.11.1.0/24
ip prefix-list FLOOR_11 seq 15 permit 10.11.2.0/23
ip prefix-list FLOOR_11 seq 20 permit 10.11.4.0/22
ip prefix-list FLOOR_11 seq 25 permit 10.11.255.0/24
route-map BGP_DENY_ONLY_DEFAULT_ROUTE deny 10
  match ip address prefix-list DEFAULT_ROUTE
route-map BGP_DENY_ONLY_DEFAULT_ROUTE permit 20
  match ip address prefix-list ANY
!
route-map BGP_PERMIT_ONLY_DEFAULT_ROUTE permit 10
  match ip address prefix-list DEFAULT_ROUTE
route-map BGP_PERMIT_ONLY_DEFAULT_ROUTE deny 20
  match ip address prefix-list ANY
!
route-map BGP_PERMIT_ALL permit 10
  match ip address prefix-list ANY
!
route-map BGP_DENY_ALL deny 10
  match ip address prefix-list ANY
!
route-map BGP_DISTRIBUTION permit 10
  match ip address prefix-list DISTRIBUTION
!
!
management api http-commands
   protocol http localhost
   protocol unix-socket
   no shutdown
   !
   vrf MGMT
      no shutdown
   !
!
management cvx
   no shutdown
   server host 10.255.1.100
   source-interface Management1
!
management ssh
   authentication mode password
   !
   vrf MGMT
      no shutdown
!
logging buffered 20480
logging trap 6
logging vrf MGMT host 10.255.1.2
!
snmp-server vrf MGMT source-interface Management1
snmp-server vrf MGMT
snmp-server view all iso included
snmp-server view all system included
snmp-server group arista_lab v3 auth read all
snmp-server user observium arista_lab v3 auth sha @r!$T@l@b!
snmp-server host 10.255.1.2 vrf MGMT version 3 auth observium
snmp-server enable traps bgp
snmp-server enable traps entity
snmp-server enable traps lldp
snmp-server enable traps snmp
